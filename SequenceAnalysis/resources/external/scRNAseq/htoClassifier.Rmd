---
title: 'Cell Hashing'
---

```{r}

library(OOSAP)

```

## Basic QC and Filtering on input:

```{r QC}

barcodeData <- ProcessCiteSeqCount(bFile = barcodeDir, doRowFilter = doHtoFilter, maxValueForColSumFilter = maxValueForColSumFilter)
if (nrow(barcodeData) == 0) {
  print('No passing HTOs')
}

if (ncol(barcodeData) == 0) {
  print('No passing cells')
}

if (nrow(barcodeData) > 0 && ncol(barcodeData) > 0){
    GenerateQcPlots(barcodeData)
}

```

## Generate calls

```{r GenerateCalls}

if (nrow(barcodeData) > 0 && ncol(barcodeData) > 0){
    dt <- GenerateCellHashingCalls(barcodeData = barcodeData, outFile = finalCallFile, allCallsOutFile = allCallsOutFile)

    if (exists('whitelistFile') && !is.null(whitelistFile)){
      GenerateSummaryForExpectedBarcodes(dt, whitelistFile=whitelistFile, outputFile=metricsFile, barcodeData=barcodeData)
    }
}

```