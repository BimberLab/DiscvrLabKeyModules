```{r}

library(OOSAP)

```

## Basic QC and Filtering on input:

```{r QC}

barcodeData <- ProcessCiteSeqCount(bFile = barcodeDir, doRowFilter = doHtoFilter)
if (nrow(barcodeData) == 0) {
  stop('No passing HTOs')
}

if (ncol(barcodeData) == 0) {
  stop('No passing cells')
}

GenerateQcPlots(barcodeData)

```

## Generate calls

```{r GenerateCalls}

dt <- GenerateCellHashingCalls(barcodeData = barcodeData, outFile = finalCallFile, allCallsOutFile = allCallsOutFile)

if (exists('whitelistFile') && !is.null(whitelistFile)){
  GenerateSummaryForExpectedBarcodes(dt, whitelistFile=whitelistFile, outputFile='metrics.txt', barcodeData=barcodeData)
}

```