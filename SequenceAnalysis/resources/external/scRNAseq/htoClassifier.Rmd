```{r}

source('https://raw.githubusercontent.com/bbimber/rnaseq/master/seurat/cellHashingFunctions.R')

```

## Basic QC and Filtering on input:

```{r QC}

barcodeData <- processCiteSeqCount(barcodeFile)
if (nrow(barcodeData) == 0) {
  stop('No passing HTOs')
}

if (ncol(barcodeData) == 0) {
  stop('No passing cells')
}

generateQcPlots(barcodeData)

```

## Using Seurat:

```{r Seurat}

sc <- generateCellHashCallsSeurat(barcodeData)

```

## Using MULTI-seq Classifier:

```{r MULTI-seq}

mc <- generateCellHashCallsMultiSeq(barcodeData)

```

## Merge calls

```{r ProcessCalls}

dt <- processEnsemblHtoCalls(mc, sc, barcodeData, outFile = finalCallFile, allCallsOutFile = allCallsOutFile)

```